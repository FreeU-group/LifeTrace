# LifeTrace 默认配置文件

# 服务器配置
server:
  host: '127.0.0.1'
  port: 8000

# 基础目录配置
base_dir: 'data'
database_path: 'lifetrace.db'
screenshots_dir: 'screenshots/'
plans_dir: 'plans/'
plan_images_dir: 'plan_images/'

# 日志配置
logging:
  level: 'INFO'
  log_path: 'logs/'

# 调度器配置
scheduler:
  enabled: true  # 启用调度器
  database_path: 'scheduler.db'  # 调度器数据库路径
  max_workers: 10  # 最大工作线程数
  coalesce: true  # 合并错过的任务
  max_instances: 1  # 同一任务同时只能有一个实例
  misfire_grace_time: 60  # 错过触发时间的容忍度（秒）
  timezone: 'Asia/Shanghai'  # 时区

# 定时任务
jobs:
  recorder:
    name: '屏幕录制'  # 任务显示名称
    enabled: true  # 是否启用录制器任务
    interval: 10 # 截图间隔（秒）
    screens: 'all'  # 截图屏幕：all 或屏幕编号列表
    auto_exclude_self: true # 自动排除 LifeTrace 自身窗口
    blacklist:
      enabled: false # 是否启用黑名单功能
      apps: ["微信"]  # 应用黑名单，使用友好名称，例如: ["微信", "QQ", "钉钉"]
      windows: []  # 窗口标题黑名单，例如: ["记事本", "计算器"]
  ocr:
    name: 'OCR识别'  # 任务显示名称
    enabled: true  # 是否启用OCR任务
    interval: 10  # 数据库检查间隔（秒）
    use_gpu: false
    language: ['ch', 'en']
    confidence_threshold: 0.5
  task_context_mapper:
    name: '任务上下文映射'  # 任务显示名称
    enabled: false  # 是否启用任务上下文映射服务
    interval: 60  # 检查间隔（秒）
    batch_size: 10  # 每次处理的上下文数量
    confidence_threshold: 0.7  # 置信度阈值，只有超过此阈值的关联才会被应用
  task_summary:
    name: '任务摘要生成'  # 任务显示名称
    enabled: false  # 是否启用任务摘要服务
    interval: 3600  # 检查间隔（秒）
    min_new_contexts: 5  # 触发摘要的最小新上下文数量
  clean_data:
    name: '截图清理'  # 任务显示名称
    enabled: true  # 是否启用截图清理任务
    interval: 3600  # 检查间隔（秒），默认每小时检查一次
    max_screenshots: 10000  # 最大截图数量限制
    delete_file_only: true  # 只删除文件（true），还是同时删除记录（false）

# 存储配置
storage:
  max_days: 30  # 数据保留天数
  deduplicate: true  # 启用去重

# 处理配置
processing:
  batch_size: 10
  queue_size: 100

# 一致性检查配置
consistency_check:
  interval: 300  # 一致性检查间隔（秒）

# 向量数据库配置
vector_db:
  enabled: true  # 启用向量数据库
  collection_name: 'lifetrace_ocr'  # 集合名称
  embedding_model: 'shibing624/text2vec-base-chinese'  # 嵌入模型
  rerank_model: 'BAAI/bge-reranker-base'  # 重排序模型
  persist_directory: 'vector_db'  # 持久化目录
  chunk_size: 512  # 文本块大小
  chunk_overlap: 50  # 文本块重叠
  batch_size: 32  # 批处理大小
  auto_sync: true  # 自动同步
  sync_interval: 300  # 同步间隔（秒）

# 多模态向量数据库配置（图像+文本联合嵌入）
multimodal:
  enabled: false  # 禁用多模态功能以节省内存（~600-800MB）
  text_weight: 0.6  # 文本权重
  image_weight: 0.4  # 图像权重
  # 注意：启用多模态需要安装额外依赖：pip install torch transformers clip-by-openai

# 同步服务配置
sync_service:
  enable_file_monitor: true  # 启用文件监控
  enable_consistency_check: true  # 启用一致性检查
  consistency_check_interval: 300  # 一致性检查间隔（秒）
  vector_sync_interval: 600  # 向量数据库同步间隔（秒）
  file_monitor_delay: 2.0  # 文件监控延迟（秒）
  cleanup_orphaned_files: true  # 清理孤立文件
  log_level: 'INFO'  # 日志级别

# LLM配置
llm:
  api_key: 'YOUR_LLM_KEY_HERE'  # LLM 密钥，需要用户配置
  base_url: 'https://dashscope.aliyuncs.com/compatible-mode/v1'  # LLM API基础URL
  model: 'qwen3-max'  # 使用的模型名称
  temperature: 0.7  # 温度参数
  max_tokens: 2048  # 最大token数

# 聊天配置
chat:
  local_history: true  # 是否启用本地历史记录
  history_limit: 6  # 历史记录条数限制
